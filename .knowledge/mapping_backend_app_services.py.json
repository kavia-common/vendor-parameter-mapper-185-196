{"is_source_file": true, "format": "Python", "description": "This file defines various service functions for managing vendors and mappings, including CRUD operations, listing, resolving mappings, and history tracking, in a MongoDB-backed backend. It provides core logic for vendor and mapping management within a larger application.", "external_files": ["../db", "../errors"], "external_methods": ["get_db", "NotFoundError", "ConflictError", "ValidationError"], "published": ["list_vendors", "create_vendor", "get_vendor", "update_vendor", "delete_vendor", "list_mappings", "create_mapping", "bulk_upsert_mappings", "get_mapping", "update_mapping", "delete_mapping", "list_history", "resolve_mapping"], "classes": [], "methods": [{"name": "ObjectId _oid(oid_str: str)", "description": "Converts a string to a validated ObjectId, raises ValidationError if invalid.", "scope": "", "scopeKind": ""}, {"name": "Tuple[List[Dict],int] list_vendors(page: int = 1, page_size: int = 50)", "description": "Lists vendors with pagination, returning items and total count.", "scope": "", "scopeKind": ""}, {"name": "Dict create_vendor(data: Dict)", "description": "Creates a new vendor document in the database.", "scope": "", "scopeKind": ""}, {"name": "Dict get_vendor(vendor_id: str)", "description": "Fetches a vendor by its id.", "scope": "", "scopeKind": ""}, {"name": "Dict update_vendor(vendor_id: str, data: Dict)", "description": "Updates vendor fields; partial updates.", "scope": "", "scopeKind": ""}, {"name": "None delete_vendor(vendor_id: str)", "description": "Deletes a vendor and associated mappings/history.", "scope": "", "scopeKind": ""}, {"name": "Dict _vendor_to_dict(doc: Dict)", "description": "Serializes vendor document into a dict.", "scope": "", "scopeKind": ""}, {"name": "Tuple[List[Dict],int] list_mappings( vendor_id: Optional[str] = None, namespace: Optional[str] = None, page: int = 1, page_size: int = 50, )", "description": "Lists mappings with optional filters and pagination.", "scope": "", "scopeKind": ""}, {"name": "Dict create_mapping(data: Dict)", "description": "Creates a new mapping for a vendor and namespace.", "scope": "", "scopeKind": ""}, {"name": "int bulk_upsert_mappings(items: List[Dict])", "description": "Upserts multiple mappings, updating or creating as needed.", "scope": "", "scopeKind": ""}, {"name": "Dict get_mapping(mapping_id: str)", "description": "Retrieves a mapping by its id.", "scope": "", "scopeKind": ""}, {"name": "Dict update_mapping(mapping_id: str, data: Dict)", "description": "Updates attributes of an existing mapping.", "scope": "", "scopeKind": ""}, {"name": "None delete_mapping(mapping_id: str)", "description": "Deletes a mapping and records history.", "scope": "", "scopeKind": ""}, {"name": "Dict _mapping_to_dict(doc: Dict)", "description": "Serializes mapping document into a dict.", "scope": "", "scopeKind": ""}, {"name": "_record_history(mapping_doc: Dict, change_type: str, db=None)", "description": "Records a history event for a mapping.", "scope": "", "scopeKind": ""}, {"name": "List[Dict] list_history(mapping_id: Optional[str] = None, vendor_id: Optional[str] = None)", "description": "Lists history records, optionally filtered by mapping or vendor.", "scope": "", "scopeKind": ""}, {"name": "Dict _history_to_dict(doc: Dict)", "description": "Serializes a history document into a dict.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Dict,List[Dict]] resolve_mapping( vendor_id: str, parameters: List[str], namespace: str = \"default\", values: Optional[Dict] = None, )", "description": "Resolves mappings based on vendor, parameters, and optional values, applying transformations.", "scope": "", "scopeKind": ""}, {"name": "_apply_transform(transform: Optional[str], value)", "description": "Applies specified transform operations to a value for mapping.", "scope": "", "scopeKind": ""}], "calls": ["get_db", "ObjectId", "db.vendors.find_one", "db.vendors.insert_one", "db.vendors.find_one_and_update", "db.vendors.delete_one", "db.mappings.find", "db.mappings.find_one", "db.mappings.insert_one", "db.mappings.find_one_and_update", "db.mappings.delete_one", "db.mapping_history.insert_one", "db.mapping_history.find", "db.mapping_history.delete_one"], "search-terms": ["vendor management", "mapping CRUD", "mapping resolution", "history tracking", "MongoDB", "mapping namespace", "vendor ID", "mapping version"], "state": 2, "file_id": 11, "knowledge_revision": 53, "git_revision": "3f68758f706c39657511e246df70aaad50baf3b6", "revision_history": [{"23": ""}, {"53": "3f68758f706c39657511e246df70aaad50baf3b6"}], "ctags": [{"_type": "tag", "name": "_apply_transform", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _apply_transform(transform: Optional[str], value):$/", "language": "Python", "kind": "function", "signature": "(transform: Optional[str], value)"}, {"_type": "tag", "name": "_history_to_dict", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _history_to_dict(doc: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(doc: Dict)"}, {"_type": "tag", "name": "_mapping_to_dict", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _mapping_to_dict(doc: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(doc: Dict)"}, {"_type": "tag", "name": "_oid", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _oid(oid_str: str) -> ObjectId:$/", "language": "Python", "typeref": "typename:ObjectId", "kind": "function", "signature": "(oid_str: str)"}, {"_type": "tag", "name": "_record_history", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _record_history(mapping_doc: Dict, change_type: str, db=None):$/", "language": "Python", "kind": "function", "signature": "(mapping_doc: Dict, change_type: str, db=None)"}, {"_type": "tag", "name": "_vendor_to_dict", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def _vendor_to_dict(doc: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(doc: Dict)"}, {"_type": "tag", "name": "bulk_upsert_mappings", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def bulk_upsert_mappings(items: List[Dict]) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(items: List[Dict])"}, {"_type": "tag", "name": "create_mapping", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def create_mapping(data: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(data: Dict)"}, {"_type": "tag", "name": "create_vendor", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def create_vendor(data: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(data: Dict)"}, {"_type": "tag", "name": "delete_mapping", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def delete_mapping(mapping_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(mapping_id: str)"}, {"_type": "tag", "name": "delete_vendor", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def delete_vendor(vendor_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(vendor_id: str)"}, {"_type": "tag", "name": "get_mapping", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def get_mapping(mapping_id: str) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(mapping_id: str)"}, {"_type": "tag", "name": "get_vendor", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def get_vendor(vendor_id: str) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(vendor_id: str)"}, {"_type": "tag", "name": "list_history", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def list_history(mapping_id: Optional[str] = None, vendor_id: Optional[str] = None) -> List[Dict/", "language": "Python", "typeref": "typename:List[Dict]", "kind": "function", "signature": "(mapping_id: Optional[str] = None, vendor_id: Optional[str] = None)"}, {"_type": "tag", "name": "list_mappings", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def list_mappings($/", "language": "Python", "typeref": "typename:Tuple[List[Dict],int]", "kind": "function", "signature": "( vendor_id: Optional[str] = None, namespace: Optional[str] = None, page: int = 1, page_size: int = 50, )"}, {"_type": "tag", "name": "list_vendors", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def list_vendors(page: int = 1, page_size: int = 50) -> Tuple[List[Dict], int]:$/", "language": "Python", "typeref": "typename:Tuple[List[Dict],int]", "kind": "function", "signature": "(page: int = 1, page_size: int = 50)"}, {"_type": "tag", "name": "resolve_mapping", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def resolve_mapping($/", "language": "Python", "typeref": "typename:Tuple[Dict,List[Dict]]", "kind": "function", "signature": "( vendor_id: str, parameters: List[str], namespace: str = \"default\", values: Optional[Dict] = None, )"}, {"_type": "tag", "name": "update_mapping", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def update_mapping(mapping_id: str, data: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(mapping_id: str, data: Dict)"}, {"_type": "tag", "name": "update_vendor", "path": "/home/kavia/workspace/code-generation/vendor-parameter-mapper-185-196/mapping_backend/app/services.py", "pattern": "/^def update_vendor(vendor_id: str, data: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(vendor_id: str, data: Dict)"}], "hash": "25e7ca26a9595260bc389b3cee488cc0", "format-version": 4, "code-base-name": "mapping_backend", "filename": "mapping_backend/app/services.py"}